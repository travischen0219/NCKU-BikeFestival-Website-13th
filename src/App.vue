<template lang="pug">
  div(id="app")
    div(id="logo")
      svg(viewBox="100 0 700 700")
        title logo
        path(class="cls-1" d="M609,165.86a14.27,14.27,0,1,1,14.27-14.27A14.29,14.29,0,0,1,609,165.86ZM609,145a6.55,6.55,0,1,0,6.55,6.55A6.55,6.55,0,0,0,609,145Z")
        path(class="cls-1" d="M662.15,172.79H552.85a3.86,3.86,0,1,0,0,7.73h48.71l-39.38,74.31a3.86,3.86,0,1,0,6.82,3.62l39.13-73.84,43,74a3.86,3.86,0,1,0,6.68-3.88L614.7,180.51h47.45a3.86,3.86,0,1,0,0-7.73Z")
        path(class="cls-1" d="M273,264.76a3.86,3.86,0,0,1,0-7.73,4.36,4.36,0,0,0,3.34-1.59c5.86-6.15,7.15-26.66,6.59-38.15a3.86,3.86,0,1,1,7.72-.38c.17,3.38,1.33,33.32-8.71,43.86A12.15,12.15,0,0,1,273,264.76Z")
        path(class="cls-1" d="M384,258c-5.24.25-10-1.63-14.45-5.77-16.6-15.35-24.09-55.89-27.39-84.79h31.31a3.86,3.86,0,1,0,0-7.73H341.31c-1.34-13.83-1.67-23.53-1.68-23.83a3.86,3.86,0,1,0-7.72.23c0,1.18.35,10.48,1.59,23.6h-20.9a27.85,27.85,0,1,0,0,55.69c.12,0,.23,0,.35,0s.23,0,.35,0a20.12,20.12,0,0,1,0,40.24,3.86,3.86,0,1,0,0,7.73,27.85,27.85,0,0,0,0-55.69c-.12,0-.23,0-.35,0s-.23,0-.35,0a20.12,20.12,0,1,1,0-40.24h21.7c3.37,30,11.36,73.24,30,90.46,5.63,5.21,11.94,7.85,18.77,7.85.43,0,.86,0,1.3,0A3.86,3.86,0,0,0,384,258Z")
        path(class="cls-1" d="M366.44,215.77a13.87,13.87,0,1,1,13.87-13.87A13.88,13.88,0,0,1,366.44,215.77Zm0-20a6.14,6.14,0,1,0,6.14,6.14A6.15,6.15,0,0,0,366.44,195.76Z")
        circle(class="cls-2" cx="358.83" cy="150.74" r="11.38")
        path(class="cls-1" d="M317.27,322.35A26.37,26.37,0,0,1,290.94,296a3.86,3.86,0,1,1,7.73,0,18.63,18.63,0,0,0,18.61,18.61,3.86,3.86,0,1,1,0,7.73Z")
        path(class="cls-1" d="M345,322.87a3.86,3.86,0,1,1,0-7.73,18.63,18.63,0,0,0,18.61-18.61,3.86,3.86,0,0,1,7.73,0A26.37,26.37,0,0,1,345,322.87Z")
        circle(class="cls-2" cx="353.8" cy="359.43" r="11.38")
        path(class="cls-1" d="M380.43,359.2a27,27,0,1,0-45.85,19.25H309.26a18.61,18.61,0,1,1,0-37.23h15.85a3.86,3.86,0,0,0,0-7.73H309.26a26.34,26.34,0,1,0,0,52.68h44.6A26.37,26.37,0,0,0,377.73,371,26.81,26.81,0,0,0,380.43,359.2Zm-46.23,0a19.24,19.24,0,0,1,38.48-.54,3.82,3.82,0,0,0-.2,1.18A18.5,18.5,0,0,1,371,367a19.24,19.24,0,0,1-36.83-7.82Z")
        path(class="cls-1" d="M389.29,413.06h-54V396.83a3.86,3.86,0,1,0-7.73,0v16.23H294.39a18.63,18.63,0,0,1-18.61-18.61,3.86,3.86,0,1,0-7.73,0,26.37,26.37,0,0,0,26.34,26.34h33.19v15.3a3.86,3.86,0,1,0,7.73,0v-15.3h54a3.86,3.86,0,0,0,0-7.73Z")
        circle(class="cls-2" cx="472.65" cy="359.2" r="15.16")
        path(class="cls-1" d="M504.65,410.27H476.19V396.85a37.18,37.18,0,0,0,.34-74V311.52h49.13a3.86,3.86,0,0,0,0-7.73H476.53V287.26a3.88,3.88,0,0,0-7.73,0V303.8H434.68c-9.75,0-17.68-7.28-17.68-16.23a3.86,3.86,0,1,0-7.73,0c0,13.21,11.4,24,25.41,24H468.8v11.34a37.17,37.17,0,0,0-.33,73.92s0,0,0,0v13.44H413.14a3.86,3.86,0,0,0,0,7.73h55.33v21.79a3.87,3.87,0,0,0,7.73,0V418h28.46c9.65,0,17.81,6.33,17.81,13.82a3.86,3.86,0,1,0,7.73,0C530.19,419.93,518.73,410.27,504.65,410.27Zm-61.76-50.43a29.76,29.76,0,1,1,8.72,21A29.57,29.57,0,0,1,442.89,359.84Z")
        circle(class="cls-2" cx="578.11" cy="365.92" r="11.38")
        path(class="cls-1" d="M574.2,333.3a16.16,16.16,0,0,1-11.46-4.74,3.86,3.86,0,0,1,5.46-5.46,8.48,8.48,0,1,0,12-12,3.86,3.86,0,0,1,5.46-5.46A16.2,16.2,0,0,1,574.2,333.3Z")
        path(class="cls-1" d="M636.57,333.3a16.16,16.16,0,0,1-11.46-4.74,3.86,3.86,0,0,1,5.46-5.46,8.48,8.48,0,1,0,12-12,3.86,3.86,0,1,1,5.46-5.46,16.2,16.2,0,0,1-11.46,27.66Z")
        path(class="cls-1" d="M599.31,400.1a3.86,3.86,0,0,0-3.86,3.86v7a18.61,18.61,0,1,1-37.23,0V385.67a27,27,0,1,0,7.49-43.14,26.37,26.37,0,0,0-15.21,23.87V411a26.34,26.34,0,1,0,52.68,0v-7A3.86,3.86,0,0,0,599.31,400.1Zm-2.59-33.3a19.25,19.25,0,1,1-27.07-17.58,18.5,18.5,0,0,1,7.18-1.44,3.83,3.83,0,0,0,1.18-.2A19.26,19.26,0,0,1,596.72,366.79Z")
        path(class="cls-1" d="M616.09,439.07a3.86,3.86,0,0,1-3.86-3.86V368.13c0-15.13,11.66-27.44,26-27.44s26,12.31,26,27.44l-.06,22.14c0,14.51-11.19,26.33-25,26.33a3.86,3.86,0,0,1,0-7.73c9.5,0,17.23-8.35,17.23-18.61l.06-22.14c0-10.86-8.19-19.71-18.26-19.71S620,357.26,620,368.13v67.08A3.86,3.86,0,0,1,616.09,439.07Z")
        path(class="cls-1" d="M438.1,252.86c-12.44,2.24-24.65-7.53-27.21-21.78s5.48-27.66,17.92-29.89c9.27-1.67,18.64,3.22,23.87,12.45a2.68,2.68,0,0,1-.63,3.47,2.13,2.13,0,0,1-3.09-.88c-4.21-7.44-11.77-11.38-19.25-10-10,1.8-16.52,12.62-14.45,24.11s11.91,19.37,21.95,17.56c7.62-1.37,13.51-8.11,14.64-16.78a2.15,2.15,0,0,1,2.53-2,2.66,2.66,0,0,1,1.88,3C454.85,242.8,447.55,251.16,438.1,252.86Z")
        path(class="cls-1" d="M514.23,239.17c-12.44,2.24-24.65-7.53-27.22-21.78a29.11,29.11,0,0,1,.3-12,2.1,2.1,0,0,1,2.73-1.64,2.72,2.72,0,0,1,1.58,3.18,23.48,23.48,0,0,0-.24,9.65c2.07,11.49,11.91,19.37,21.95,17.56s16.52-12.62,14.45-24.11a23.46,23.46,0,0,0-3.59-9,2.72,2.72,0,0,1,.37-3.53,2.1,2.1,0,0,1,3.13.59,29.11,29.11,0,0,1,4.46,11.13C534.72,223.52,526.68,236.93,514.23,239.17Z")
        path(class="cls-2" d="M511.57,212.2l-26.92-21.54,6.58-11a2.81,2.81,0,0,0-.64-3.54,2,2,0,0,0-3.09.56l-22.27,37.15-5.06-28.13a2.57,2.57,0,0,0-1.76-2.07,2,2,0,0,0-2.28,1l-24.53,40.92a2.81,2.81,0,0,0,.64,3.54,2,2,0,0,0,3.09-.56l21.57-36,5.06,28.13h0l1.09,6.07-4.16.75a2.56,2.56,0,0,0,.9,5l6.34-1.14,6.63-1.19a2.56,2.56,0,0,0-.9-5l-4.45.8-.91-5,15.69-26.17,26.92,21.54a2,2,0,0,0,3.09-.56A2.81,2.81,0,0,0,511.57,212.2Z")
        path(class="cls-1" d="M461.16,180.5,447.44,183a3.66,3.66,0,0,1-1.28-7.14l13.73-2.47a3.66,3.66,0,0,1,1.28,7.14Z")
        path(class="cls-2" d="M508.23,187.28l-14.77,2.66a2.56,2.56,0,0,1-.9-5l14.77-2.66a2.56,2.56,0,0,1,.9,5Z")
        path(class="cls-3" d="M282.44,509.72h-4l-11.06-17a10.48,10.48,0,0,1-.9-1.63h-.09a27.35,27.35,0,0,1,.13,3.37v15.29h-3.48V486.61h4.24L278,503.32q.76,1.19,1,1.66h.07a24.22,24.22,0,0,1-.16-3.31V486.61h3.49Z")
        path(class="cls-3" d="M311.9,508.81a14.26,14.26,0,0,1-6.46,1.3,10.61,10.61,0,0,1-8-3.15,11.54,11.54,0,0,1-3-8.33,12.35,12.35,0,0,1,3.35-8.9,11.41,11.41,0,0,1,8.63-3.5,14.39,14.39,0,0,1,5.54.93v3.63a10.87,10.87,0,0,0-5.42-1.37,7.83,7.83,0,0,0-6.06,2.48,9.23,9.23,0,0,0-2.28,6.5,8.92,8.92,0,0,0,2.14,6.21A7.35,7.35,0,0,0,306,507a11.13,11.13,0,0,0,5.88-1.54Z")
        path(class="cls-3" d="M341.17,509.72h-4.76l-8.15-10.39a4.25,4.25,0,0,1-.61-1h-.07v11.36H324V486.61h3.58V497.5h.07a6.34,6.34,0,0,1,.63-1l7.83-9.92h4.36l-9.25,11.07Z")
        path(class="cls-3" d="M369.18,500.14q0,10-9.12,10-8.75,0-8.74-9.64V486.61h3.58v13.77q0,6.58,5.43,6.58,5.27,0,5.27-6.36v-14h3.58Z")
        path(class="cls-3" d="M395.93,509.72V486.61h7.22a8.28,8.28,0,0,1,5.15,1.45,4.65,4.65,0,0,1,1.89,3.89,5.25,5.25,0,0,1-1.15,3.36,6,6,0,0,1-3,2v.06a6,6,0,0,1,3.8,1.78,5.31,5.31,0,0,1,1.44,3.82,6.12,6.12,0,0,1-2.16,4.87,8.41,8.41,0,0,1-5.69,1.86Zm3.58-20.17v6.76h2.6a4.7,4.7,0,0,0,3.18-1,3.39,3.39,0,0,0,1.13-2.7q0-3.07-4.21-3.07Zm0,9.71v7.52h3.37a5.15,5.15,0,0,0,3.4-1,3.48,3.48,0,0,0,1.21-2.82q0-3.69-5-3.69Z")
        path(class="cls-3" d="M429,489.53h-2.15V506.8H429v2.92h-7.86V506.8h2.13V489.53h-2.13v-2.92H429Z")
        path(class="cls-3" d="M457.45,509.72h-4.76l-8.15-10.39a4.25,4.25,0,0,1-.61-1h-.07v11.36h-3.58V486.61h3.58V497.5h.07a6.34,6.34,0,0,1,.63-1l7.83-9.92h4.36l-9.25,11.07Z")
        path(class="cls-3" d="M480.67,509.72h-12.8V486.61h12.28v3.07h-8.7v6.8h8.07v3.06h-8.07v7.1h9.22Z")
        path(class="cls-3" d="M520.07,489.68h-8.71v7.18h8v3.06h-8v9.8h-3.58V486.61h12.3Z")
        path(class="cls-3" d="M544.71,509.72H531.9V486.61h12.28v3.07h-8.7v6.8h8.07v3.06h-8.07v7.1h9.22Z")
        path(class="cls-3" d="M555.48,504.93a9.59,9.59,0,0,0,6.25,2.16q4.59,0,4.6-3.15a2.81,2.81,0,0,0-.51-1.64,4.69,4.69,0,0,0-1.37-1.28,38.09,38.09,0,0,0-3.39-1.75,12.57,12.57,0,0,1-4.36-3,5.59,5.59,0,0,1-1.24-3.61,5.5,5.5,0,0,1,2.36-4.7,10,10,0,0,1,6-1.72,12.61,12.61,0,0,1,5.25.85v3.67a9.14,9.14,0,0,0-5.33-1.48,5.94,5.94,0,0,0-3.3.82,2.56,2.56,0,0,0-1.25,2.25,2.75,2.75,0,0,0,.92,2.13,17.91,17.91,0,0,0,3.87,2.24,13.58,13.58,0,0,1,4.76,3.23,5.74,5.74,0,0,1,1.31,3.72,5.57,5.57,0,0,1-2.27,4.79,10.47,10.47,0,0,1-6.28,1.66,17,17,0,0,1-3.28-.36,8.56,8.56,0,0,1-2.78-1Z")
        path(class="cls-3" d="M596.62,489.68H590v20h-3.6v-20h-6.63v-3.07h16.86Z")
        path(class="cls-3" d="M613.42,489.53h-2.15V506.8h2.15v2.92h-7.86V506.8h2.13V489.53h-2.13v-2.92h7.86Z")
        path(class="cls-3" d="M642.61,486.61l-8.34,23.11h-4l-8.21-23.11H626l5.85,17.53a10.32,10.32,0,0,1,.46,2.15h.07a9.8,9.8,0,0,1,.52-2.18l5.92-17.5Z")
        path(class="cls-3" d="M672.13,509.72h-3.94l-2.16-6h-9.25l-2.06,6h-3.94l8.71-23.11h4Zm-7.1-9-3.22-9.12a10,10,0,0,1-.36-1.75h-.1a8.71,8.71,0,0,1-.37,1.72l-3.21,9.15Z")
        path(class="cls-3" d="M695.6,509.72H683V486.61h3.58v20h9Z")
    transition-page
      router-view
</template>

<script>
import anime from 'animejs'
import Intro from './components/Intro'
import TransitionPage from './components/TransitionPage'

const DEFAULT_TRANSITION = 'fade'
const DEFAULT_TRANSITION_MODE = 'in-out'

export default {
  name: 'App',
  components: {
    Intro,
    TransitionPage
  },
  data: function () {
    return {
      transitionName: DEFAULT_TRANSITION,
      transitionMode: DEFAULT_TRANSITION_MODE,
      transitionEnterActiveClass: ''
    }
  },
  created: function () {
    this.$router.beforeEach((to, from, next) => {
      let transitionName = to.meta.transitionName || from.meta.transitionName || DEFAULT_TRANSITION
      this.transitionMode = DEFAULT_TRANSITION_MODE
      this.transitionEnterActiveClass = `${transitionName}-enter-active`

      if (to.meta.transitionName === 'zoom-in') {
        this.transitionMode = 'in-out'
        this.transitionEnterActiveClass = 'zoom-enter-active'
        // Disable scrolling in the background.
        document.body.style.overflow = 'hidden'
      }
      if (from.meta.transitionName === 'zoom-out') {
        this.transitionMode = null
        this.transitionEnterActiveClass = null
        // Enable scrolling again.
        document.body.style.overflow = null
      }
      this.transitionName = transitionName
      next()
    })
  },
  mounted: function () {
    // config click event
    document.addEventListener('click', this.clickEffect)
    const self = this
    const logo = this.$el.querySelector('#logo')
    if (this.$route.name !== 'Intro') {
      logo.parentNode.removeChild(logo)
      return
    }
    // add logo line animation
    anime({
      targets: 'svg path, svg circle',
      strokeDashoffset: [anime.setDashoffset, 0],
      easing: 'easeInOutCubic',
      duration: 3000,
      delay: function (el, i) { return 0 },
      begin: function (anim) {
        self.$el.querySelectorAll('.cls-1').forEach(target => {
          target.classList.add('fill-logo')
        })
        self.$el.querySelectorAll('.cls-2').forEach(target => {
          target.classList.add('fill-logo')
        })
        self.$el.querySelectorAll('.cls-3').forEach(target => {
          target.classList.add('fill-logo')
        })
      },
      complete: function (anim) {
        setTimeout(function () {
          logo.classList.add('slide-up')
          const transEndEvent = function () {
            logo.removeEventListener('transitionend', transEndEvent)
            logo.parentNode.removeChild(logo)
          }
          logo.addEventListener('transitionend', transEndEvent)
        }, 1500)
      }
    })
  },
  methods: {
    clickEffect: function (e) {
      const d = document.createElement('div')
      d.className = 'clickEffect'
      d.style.top = `${e.clientY - 100}px`
      d.style.left = `${e.clientX - 100}px`
      document.body.appendChild(d)
      d.addEventListener('animationend', function () {
        d.parentElement.removeChild(d)
        d.removeEventListener('animationend', this)
      })
    },
    beforeLeave: function () {

    },
    enter: function () {

    },
    afterEnter: function () {

    }
  }
}
</script>

<style lang="scss">
  @import url(https://fonts.googleapis.com/earlyaccess/cwtexyen.css);

  @keyframes clickEffect {
    0% {
      opacity: 1;
      transform: scale(0.1);
      border-width: 2.5em;
    }
    100% {
      opacity: 0.2;
      transform: scale(1);
      border-width: 0.03em;
    }
  }

  @keyframes dot-loading {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }

  @keyframes fill-text {
    0% {
      fill-opacity: 0;
      stroke: #942323;
      stroke-width: 2px;
    }
    85% {
      fill-opacity: 0;
      stroke: #942323;
      stroke-width: 1.8px;
    }
    100% {
      fill-opacity: 1;
      stroke: white;
      stroke-width: 1px;
    }
  }

  .zoom-enter-active,
  .zoom-leave-active {
    animation-duration: 0.5s;
    animation-fill-mode: both;
    animation-name: zoom;
  }

  .zoom-leave-active {
    animation-direction: reverse;
  }

  @keyframes zoom {
    from {
      opacity: 0;
      transform: scale3d(0.3, 0.3, 0.3);
    }

    100% {
      opacity: 1;
    }
  }

  body {
    margin: 0;
    padding: 0;
    transform-origin: 0 0;
    font-family: ‘cwTeXYen’, sans-serif;
    overflow: hidden;
  }
  #app {
    font-family: 'Avenir', Helvetica, Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-align: center;
    color: #2c3e50;
    margin-top: 60px;
    overflow: hidden;
    margin: 0;
    padding: 0;
  }

  .clickEffect {
    position: fixed;
    width: 200px;
    height: 200px;
    box-sizing: border-box;
    border-style: solid;
    border-color: rgba(255, 255, 255, 1);
    border-radius: 50%;
    animation: clickEffect 0.4s ease-in-out;
    transform-origin: center;
    z-index: 99999;
    will-change: opacity, transform, border-width;
    pointer-events: none;
  }

  .cls-1, .cls-4 {
    fill: #942323;
  }
  .cls-1, .cls-2, .cls-3, .cls-4 {
    stroke-width: 1.5px;
    stroke: #942323;
    stroke-miterlimit: 10;
    fill-opacity: 0;
  }
  .cls-2{
    fill: #1e556d;
  }
  .cls-3{
    fill: #133180;
  }
  .cls-4{
    stroke-width: 0.5px;
  }

  #logo {
    position: fixed;
    overflow: hidden;
    width: 100%;
    max-height: 100vh;
    z-index: 9999;
    background-color: #d9d4b3;

    transition: max-height .8s ease;

    will-change: max-height;
  }
  #logo svg {
    width: 100vw;
    height: 100vh;
    display: block;
    margin: 0 auto;
    transform: translate(-10px, 0);
  }

  .slide-up {
    max-height: 0 !important;
  }

  .fill-logo {
    animation: fill-text 3s ease-out;
    animation-fill-mode: forwards;
  }

  body.rotation-90 {
    transform: rotate(90deg) translateY(-100%);
  }
  body.rotation--90 {
    transform: rotate(-90deg) translateX(-100%);
  }
</style>
